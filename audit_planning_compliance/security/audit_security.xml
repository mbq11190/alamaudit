<odoo>
    <data noupdate="1">
        <record id="group_audit_partner" model="res.groups">
            <field name="name">Audit Partner</field>
            <field name="category_id" ref="base.module_category_hidden"/>
        </record>
        <record id="group_audit_manager" model="res.groups">
            <field name="name">Audit Manager</field>
            <field name="category_id" ref="base.module_category_hidden"/>
        </record>
        <record id="group_audit_senior" model="res.groups">
            <field name="name">Audit Senior</field>
            <field name="category_id" ref="base.module_category_hidden"/>
        </record>
        <record id="group_audit_staff" model="res.groups">
            <field name="name">Audit Staff</field>
            <field name="category_id" ref="base.module_category_hidden"/>
        </record>
        <record id="group_audit_reviewer" model="res.groups">
            <field name="name">Audit Reviewer / QCR</field>
            <field name="category_id" ref="base.module_category_hidden"/>
        </record>
        <record id="group_audit_client_portal" model="res.groups">
            <field name="name">Client Portal (Read Only)</field>
            <field name="category_id" ref="base.module_category_hidden"/>
            <field name="users" eval="[(4, ref('base.group_portal'))]"/>
        </record>

        <!-- Record rules -->
        <record id="audit_engagement_partner_rule" model="ir.rule">
            <field name="name">Audit engagement partner access</field>
            <field name="model_id" ref="model_audit_engagement"/>
            <field name="groups" eval="[(4, ref('audit_planning_compliance.group_audit_partner')), (4, ref('audit_planning_compliance.group_audit_manager'))]"/>
            <field name="domain_force">[(1,'=',1)]</field>
        </record>

        <record id="audit_engagement_staff_rule" model="ir.rule">
            <field name="name">Audit engagement staff write restriction</field>
            <field name="model_id" ref="model_audit_engagement"/>
            <field name="groups" eval="[(4, ref('audit_planning_compliance.group_audit_staff')), (4, ref('audit_planning_compliance.group_audit_senior'))]"/>
            <field name="domain_force">['|', ('assigned_user_ids','in', user.id), ('engagement_manager_id','=', user.id)]</field>
        </record>

        <record id="audit_pbc_portal_rule" model="ir.rule">
            <field name="name">PBC portal limited access</field>
            <field name="model_id" ref="model_audit_pbc_request"/>
            <field name="groups" eval="[(4, ref('audit_planning_compliance.group_audit_client_portal'))]"/>
            <field name="domain_force">[('shared_with_portal','=', True)]</field>
        </record>
    </data>
</odoo>

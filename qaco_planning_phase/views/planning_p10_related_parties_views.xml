<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- P-10: Related Parties Planning Main Form View -->
    <record id="view_audit_planning_p10_related_parties_form" model="ir.ui.view">
        <field name="name">qaco.planning.p10.related.parties.form</field>
        <field name="model">qaco.planning.p10.related.parties</field>
        <field name="arch" type="xml">
            <form string="P-10: Related Parties Planning">
                <header>
                    <field name="state" widget="statusbar"/>
                </header>
                <sheet>
                    <field name="can_open" invisible="1"/>
                    <group>
                        <group string="Audit Information">
                            <field name="audit_id"/>
                            <field name="client_id" readonly="1"/>
                        </group>
                        <group string="Status">
                            <field name="currency_id" invisible="1"/>
                        </group>
                    </group>

                    <notebook>
                        <!-- Tab 1: Risk Assessment -->
                        <page string="Risk Assessment" name="risk">
                            <group>
                                <group string="RP Risk">
                                    <field name="rp_risk_assessment" widget="html"/>
                                </group>
                                <group string="RPT Risk">
                                    <field name="rpt_risk_assessment" widget="html"/>
                                </group>
                            </group>
                            <group>
                                <field name="significant_rpt_identified"/>
                                <field name="rpt_fraud_risk_identified"/>
                                <field name="undisclosed_rp_risk"/>
                            </group>
                        </page>

                        <!-- Tab 2: Procedures -->
                        <page string="Procedures" name="procedures">
                            <group string="Planned Audit Procedures">
                                <field name="planned_procedures" widget="html"/>
                                <field name="risk_assessment_procedures" widget="html"/>
                                <field name="identification_procedures" widget="html"/>
                                <field name="substantive_procedures" widget="html"/>
                            </group>
                        </page>

                        <!-- Tab 3: Disclosure -->
                        <page string="Disclosure" name="disclosure">
                            <group>
                                <field name="disclosure_framework"/>
                                <field name="disclosure_requirements" widget="html"/>
                                <field name="disclosure_adequacy" widget="html"/>
                                <field name="ias24_compliance" widget="html"/>
                                <field name="risk_incomplete_disclosure"/>
                            </group>
                        </page>

                        <!-- Tab 4: Attachments -->
                        <page string="Attachments" name="attachments">
                            <group string="Related Party Schedules">
                                <field name="rp_schedule_attachment_ids" widget="many2many_binary" nolabel="1"/>
                            </group>
                            <group string="Supporting Documentation">
                                <field name="supporting_attachment_ids" widget="many2many_binary" nolabel="1"/>
                            </group>
                            <group string="RPT Documentation">
                                <field name="rpt_attachment_ids" widget="many2many_binary" nolabel="1"/>
                            </group>
                            <group string="Approval Documentation">
                                <field name="approval_attachment_ids" widget="many2many_binary" nolabel="1"/>
                            </group>
                        </page>

                        <!-- Tab 5: Conclusion -->
                        <page string="Conclusion" name="conclusion">
                            <group string="P-10 Conclusion">
                                <field name="rp_risk_summary" widget="html"/>
                                <field name="rpt_conclusion" widget="html"/>
                            </group>
                            <group string="Confirmations">
                                <field name="confirm_rp_complete"/>
                                <field name="confirm_rpt_risks_assessed"/>
                                <field name="confirm_audit_responses_established"/>
                            </group>
                        </page>

                        <!-- Tab 6: Review & Approval -->
                        <page string="Review &amp; Approval" name="approval">
                            <group string="ISA Reference">
                                <field name="isa_reference"/>
                            </group>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>

    <!-- P-10 Tree View -->
    <record id="view_audit_planning_p10_related_parties_tree" model="ir.ui.view">
        <field name="name">qaco.planning.p10.related.parties.tree</field>
        <field name="model">qaco.planning.p10.related.parties</field>
        <field name="arch" type="xml">
            <tree string="P-10: Related Parties">
                <field name="name"/>
                <field name="audit_id"/>
                <field name="client_id"/>
                <field name="state" widget="badge" decoration-info="state == 'not_started'"
                       decoration-warning="state == 'in_progress'" decoration-success="state == 'approved'"/>
            </tree>
        </field>
    </record>

    <!-- P-10 Action -->
    <record id="action_audit_planning_p10_related_parties" model="ir.actions.act_window">
        <field name="name">P-10: Related Parties Planning</field>
        <field name="res_model">qaco.planning.p10.related.parties</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Create P-10 Related Parties Planning
            </p>
            <p>
                Document related parties and RPT planning per ISA 550.
            </p>
        </field>
    </record>

    <!-- Menuitem -->
    <menuitem id="menu_audit_planning_p10_related_parties" 
              name="P-10: Related Parties Planning" 
              parent="qaco_planning_phase.menu_audit_planning_phase_root" 
              action="action_audit_planning_p10_related_parties" 
              sequence="110"/>
</odoo>

